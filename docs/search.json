[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "",
    "text": "Abstract. Research on how Bayesian VARs with regime change affect the forecasting of unemployment rate in Australia\nKeywords. bsvars, minnesota, dummy-observation, regime change, forecasting, R,"
  },
  {
    "objectID": "index.html#data-visualisation",
    "href": "index.html#data-visualisation",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Data Visualisation",
    "text": "Data Visualisation\n\n\n\n\n\n\n\n\n\n\n\nFigure 1: Time series plots\n\n\nTo stabilize the variance, log tranformation is performed on all variables except unemployment rate.\n\n\n\n\n\n\n\n\n\n\n\nFigure 2: Transformed Time series plots\n\n\nFrom the plot of the variables, some variables show stationary and some variables show non-stationary, which can create some challenges in general analysis . Therefore, the ACF test is performed to identify patterns and trend.\n\n\n\n\n\n\n\n\n\n\n\nFigure 3: ACF plots\n\n\nThe ACF plots show the variables have persistence or dependence in the data as the they are slowly decaying, indicates that there is a strong correlation between each variable and its past values, though this auto correlations decrease as lags increase.\n\n\n\n\n\n\n\n\n\n\n\nFigure 4: PACF plots\n\n\nThe PACF plots show high autocorrelation at lag 1, and have clear cut offs.\nThe ADF is performed to further determine the stationary properties of the data. Null hypothesis: a unit root is present. Alternative hypothesis: stationary.\n\n\n            Dickey_Fuller p_value\nunmp_df            -2.545   0.350\ngdp_df             -1.826   0.649\nwpi_df             -2.265   0.467\ncashrate_df        -3.409   0.056\n\n\nBased on the results of the ADF tests, all the variables exhibit statistical evidence suggesting that they are non-stationary, with p-value &gt; 0.05, thus failing to reject the null hypothesis. For many time series models, differencing may be necessary to achieve stationarity. However, the baseline model will incorporate Minnesota prior which is robust to non-stationary data."
  },
  {
    "objectID": "index.html#matrix-form",
    "href": "index.html#matrix-form",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Matrix form",
    "text": "Matrix form\n\\[\\begin{align*}\n\\mathbf{Y}_t = \\boldsymbol{\\beta}_{S_t} \\mathbf{X}_t + \\boldsymbol{E}_t\n\\end{align*}\\]\n\\[\\begin{align*}\n\\boldsymbol{E}_t\n\\sim MN(0_T, \\Sigma, I_T)\n\\end{align*}\\]\n\\begin{align*} \\mathbf{Y}_t & : \\text{Matrix of response variables} \\\\ \\boldsymbol{\\beta} & : \\text{Coefficient matrix corresponding to regime state} \\\\ S_t & : \\text{Regime state} \\\\ \\mathbf{X}_t & : \\text{Matrix of predictor variables} \\\\ \\boldsymbol{\\varepsilon}_t & : \\text{Error term vector} \\end{align*}\n\\begin{align*} \\mathbf{Y}_t = \\begin{pmatrix} \\text{Unemployment}_t \\\\ \\text{GDP}_t \\\\ \\text{WPI}_t \\\\ \\text{CashRate}_t \\\\ \\end{pmatrix} \\end{align*}\nThe model’s equations include time-varying parameters, such as the coefficients of lagged variables, which adapt to changing economic conditions."
  },
  {
    "objectID": "index.html#minnesota-prior-distribution",
    "href": "index.html#minnesota-prior-distribution",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Minnesota Prior distribution",
    "text": "Minnesota Prior distribution\nThe Minnesota prior is commonly used in Bayesian Vector Autoregression (BVAR) models due to its ability to impose shrinkage towards zero on the coefficients, effectively regularizing the estimation process. The Minnesota prior aligns effectively with the stylized fact of nonstationarity observed in macroeconomic variables.\n\\[\\begin{align*}\np(A, \\Sigma) = p(A \\mid \\Sigma) \\cdot p(\\Sigma) \\\\\nA \\mid \\Sigma \\sim \\text{MN}_{K \\times N} (\\underline{A}, \\Sigma, \\underline{V}) \\\\\n\\Sigma \\sim  \\text{IW}_{N} (\\underline{S}, \\underline{v})\\\\\n\\end{align*}\\]\nWith lags = 4 and N = 4\n\\[\\begin{align*}\n\\underline{A} = \\begin{bmatrix}\n\\mathbf{0}_{4 \\times 1} & \\mathbf{I}_{4} & \\mathbf{0}_{4 \\times (4-1)4}\n\\end{bmatrix}'\n= \\begin{bmatrix}\n0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\\\\n\\end{bmatrix}'\n\\end{align*}\\]\nThe column-specific prior covariance of A \\[\\begin{align*}\n\\underline{V} &= \\text{diag}\\left( \\begin{bmatrix}\nk_2 & k_1(\\mathbf{p}^{-2} \\otimes 1'_4)\n\\end{bmatrix} \\right)\\\\\n\\mathbf{p} &= \\begin{bmatrix}\n1 & 2 & 3 & 4 \\\\\n\\end{bmatrix}\n\\end{align*}\\] \\[\\begin{align*}\n& k_2 : \\text{overall shrinkage for the constant term} \\\\\n& k_1 : \\text{overall shrinkage levels for autoregressive slopes} \\\\\n\\end{align*}\\]\nPrior covariance matrix\n\\[\\begin{bmatrix}\nk_2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & k_1 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & k_1 & 0 & 0 & 0 & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & k_1 & 0 & 0 & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & 0 & k_1 & 0 & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & 0 & 0 & \\frac{k_1}{4} & 0 & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & 0 & 0 & 0 & \\frac{k_1}{4} & 0 & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & \\frac{k_1}{4} & 0 & \\cdots & 0\\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \\frac{k_1}{4} & \\cdots & 0\\\\\n\\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\vdots & \\ddots & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & \\frac{k_1}{16}      \n\\end{bmatrix}\\]"
  },
  {
    "objectID": "index.html#the-joint-posterior-distribution",
    "href": "index.html#the-joint-posterior-distribution",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "The joint posterior distribution",
    "text": "The joint posterior distribution\n\\[\\begin{align*}\np(A,\\Sigma|Y,X) &\\propto L(A,\\Sigma|Y,X)p(A,\\Sigma) \\\\\n&= L(A,\\Sigma|Y,X)p(A|\\Sigma)p(\\Sigma)\n\\end{align*}\\]\n\\[\\begin{align}\np(A,\\Sigma|Y,X) &\\propto \\det(\\Sigma)^{-\\frac{T}{2}} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(Y-XA)'(Y-XA)]\\} \\\\\n&\\times \\det(\\Sigma)^{-\\frac{N+K+\\underline{v}+1}{2}} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}(A-\\underline{A}) \\underline{V}^{-1}(A-\\underline{A})]\\} \\\\\n&\\times exp\\{-\\frac{1}{2}tr[\\Sigma^{-1}\\underline{S}]\\}\n\\end{align}\\]\nThe full conditional joint posterior have the following form \\[\\begin{align}\np(A|Y,X,\\Sigma) &\\sim MN_{K \\times N}(\\overline{A}, \\Sigma,\\overline{V} ) \\\\\np(\\Sigma|Y,X) &\\sim IW_{N}(\\overline{S}, \\overline{v})\\\\\n\\\\\n\\overline{V} &= (X'X + \\underline{V}^{-1})^{-1} \\\\\n\\overline{A} &= \\overline{V}(X'Y+\\underline{V}^{-1}\\underline{A}) \\\\\n\\overline{v} &= T + \\underline{v} \\\\\n\\overline{S} &= \\underline{S}+Y'Y+\\underline{A}'\\underline{V}^{-1}\\underline{A}-\\overline{A}'\n\\overline{V}^{-1}\\overline{A} \\\\\n\\end{align}\\]\nThe posterior draws are obtain with the following code\n\n###############################################\n# Posterior draws Normal-inverse Wishart\n###############################################\nposterior_draws       = function (S, Y, X, A.prior, V.prior, S.prior, nu.prior){\n    # Posterior parameters\n    V.bar.inv         = t(X)%*%X + diag(1/diag(V.prior))\n    V.bar             = solve(V.bar.inv)\n    A.bar             = V.bar%*%(t(X)%*%Y + diag(1/diag(V.prior))%*%A.prior)\n    nu.bar            = nrow(Y) + nu.prior\n    S.bar             = S.prior + t(Y)%*%Y + t(A.prior)%*%diag(1/diag(V.prior))%*%A.prior -\n                        t(A.bar)%*%V.bar.inv%*%A.bar\n    S.bar.inv         = solve(S.bar)\n  \n    # Posterior draws \n    Sigma.posterior   = rWishart(S, df=nu.bar, Sigma=S.bar.inv)\n    Sigma.posterior   = apply(Sigma.posterior,3,solve)\n    Sigma.posterior   = array(Sigma.posterior,c(N,N,S))\n    A.posterior       = array(rnorm(prod(c(dim(A.bar),S))),c(dim(A.bar),S))\n    L                 = t(chol(V.bar))\n    for (s in 1:S){\n      A.posterior[,,s]= A.bar + L%*%A.posterior[,,s]%*%chol(Sigma.posterior[,,s])\n    }\n \n    output            = list(A.posterior=A.posterior, Sigma.posterior=Sigma.posterior)\n    return(output)\n}\n\nsample_minnesota        = posterior_draws(S=50000, Y, X, A.prior, V.prior, S.prior, nu.prior)\nsample_minnesota_A      = sample_minnesota$A.posterior\nsample_minnesota_Sigma  = sample_minnesota$Sigma.posterior\n\n\n\n\n\nPosterior A means and standard deviations table\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n0.136077\n0.960000\n-0.021506\n0.053533\n-0.162047\n-0.037728\n0.003492\n0.014125\n0.154908\n-0.051878\n0.006933\n0.006051\n0.036237\n0.028663\n0.002400\n0.004038\n-0.000543\n\n\n3.317267\n0.119860\n0.342575\n0.366206\n0.111462\n0.132343\n0.205321\n0.207407\n0.147811\n0.102596\n0.140604\n0.141155\n0.107893\n0.078081\n0.106231\n0.106277\n0.072322\n\n\n0.005136\n0.005730\n0.998521\n-0.000516\n0.001196\n0.001224\n-0.000218\n-0.000099\n0.000603\n-0.002387\n-0.000018\n-0.000020\n-0.000633\n-0.001204\n0.000047\n-0.000021\n-0.001251\n\n\n0.109550\n0.003935\n0.011301\n0.012069\n0.003672\n0.004373\n0.006761\n0.006855\n0.004867\n0.003395\n0.004615\n0.004639\n0.003564\n0.002553\n0.003507\n0.003504\n0.002386\n\n\n\n\n\n\n\n\n\n\nPosterior Sigma means and standard deviations table\n\n\n1\n2\n3\n4\n\n\n\n\n0.184892\n-0.002195\n-0.000112\n-0.031063\n\n\n0.026188\n0.000644\n0.000065\n0.016407\n\n\n-0.002195\n0.000201\n0.000004\n0.000537\n\n\n0.000644\n0.000029\n0.000002\n0.000531\n\n\n\n\n\n\n\n\nThe trace plots and histograms posterior draws on A and \\(\\Sigma\\) shows that unemployment rate has strong positive correlation with its first lag, this is expected from observing the data properties."
  },
  {
    "objectID": "index.html#minnesota-and-dummy-observation-prior-distribution",
    "href": "index.html#minnesota-and-dummy-observation-prior-distribution",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Minnesota and dummy observation prior distribution",
    "text": "Minnesota and dummy observation prior distribution\nThe newly created matrix specified the model has 5 dummy observations. The above prior distribution is likely to encounter the problem of not having enough observations and lead to many challenges to meet the requirements for degree of freedom or invertibility of matrices. To resolve this, the combination of specifying the prior through both Normal inverse Wishart and dummy-observations is proposed, which is derived similarly to the posterior distribution in the basic model.\n\\[\\begin{align*}\nA \\mid \\Sigma &\\sim \\text{MN}_{K \\times N} (\\widetilde{A}, \\Sigma, \\widetilde{V}) \\\\\n\\Sigma &\\sim  \\text{IW}_{N} (\\widetilde{S}, \\widetilde{v})\\\\\n\\\\\n\\widetilde{A} &= \\widetilde{V}(X^{+'}Y^{+}+\\underline{V}^{-1}\\underline{A}) \\\\\n\\widetilde{V} &= (X^{+'}X^{+} + \\underline{V}^{-1})^{-1} \\\\\n\\widetilde{v} &= T^{+} + \\underline{v} \\\\\n\\widetilde{S} &= \\underline{S}+Y^{+'}Y^{+}+\\underline{A}'\\underline{V}^{-1}\\underline{A} -\\widetilde{A}'\\widetilde{V}^{-1}\\widetilde{A} \\\\\n\\end{align*}\\]"
  },
  {
    "objectID": "index.html#the-full-conditional-joint-posterior",
    "href": "index.html#the-full-conditional-joint-posterior",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "The full conditional joint posterior",
    "text": "The full conditional joint posterior\nThe full conditional joint posterior, incorporating the new priors, have the following form\n\\[\\begin{align}\np(A|Y,X,\\Sigma) &\\sim MN_{K \\times N}(\\overline{A}, \\Sigma,\\overline{V} ) \\\\\np(\\Sigma|Y,X) &\\sim IW_{N}(\\overline{S}, \\overline{v})\\\\\n\\\\\n\\overline{V} &= (X'X + \\widetilde{V}^{-1})^{-1} \\\\\n\\overline{A} &= \\overline{V}(X'Y+\\widetilde{V}^{-1}\\widetilde{A}) \\\\\n\\overline{v} &= T + \\widetilde{v} \\\\\n\\overline{S} &= \\widetilde{S}+Y'Y+\\widetilde{A}'\\widetilde{V}^{-1}\\widetilde{A}-\\overline{A}'\n\\overline{V}^{-1}\\overline{A} \\\\\n\\end{align}\\]\nThe posterior draws are obtain with the following code\n\n###############################################\n# Posterior draws for dummy prior\n###############################################\nposterior_draws_dummy = function(S, Y, X, A.prior, V.prior, S.prior, nu.prior) {\n  \n  N       = ncol(Y)\n  p       = (ncol(X) - 1)/N\n  mu      = 1000\n  delta   = 1000\n  dim(X)\n  avg_unmp &lt;- mean(X[1, c(2, 6, 10, 14)])\n  avg_gdp &lt;- mean(X[1, c(3, 7, 11, 15)])\n  avg_wpi &lt;- mean(X[1, c(4, 8, 12, 16)])\n  avg_cash &lt;- mean(X[1, c(5, 9, 13, 17)])\n  \n  diag_mu &lt;- diag(c(avg_unmp/mu, avg_gdp/mu, avg_wpi/mu, avg_cash/mu))\n  row_delta &lt;-  matrix(c(avg_unmp/delta, avg_gdp/delta, avg_wpi/delta, avg_cash/delta), nrow = 1)\n  \n  Y_d       = rbind(diag_mu, row_delta)\n  \n  first_vector &lt;- matrix(c(0,0,0,0, 1/delta), ncol = 1)\n  X_d      = cbind(first_vector, Y_d, Y_d, Y_d, Y_d)\n  \n  # Normal-inverse Wishart combination of specifying the prior \n  ############################################################\n  V.tilde.inv   = t(X_d)%*%X_d + diag(1/diag(V.prior))\n  V.tilde       = solve(V.tilde.inv)\n  A.tilde       = V.tilde%*%(t(X_d)%*%Y_d + diag(1/diag(V.prior))%*%A.prior)\n  nu.tilde      = nrow(Y_d) + nu.prior\n  S.tilde       = S.prior + t(Y_d)%*%Y_d + t(A.prior)%*%diag(1/diag(V.prior))%*%A.prior -\n    t(A.tilde)%*%V.tilde.inv%*%A.tilde\n  S.tilde.inv   = solve(S.tilde)\n\n  # Normal-inverse Wishart posterior parameters\n  V.bar.inv   = t(X)%*%X + diag(1/diag(V.tilde))\n  V.bar       = solve(V.bar.inv)\n  A.bar       = V.bar%*%(t(X)%*%Y + diag(1/diag(V.tilde))%*%A.tilde)\n  nu.bar      = nrow(Y) + nu.tilde\n  S.bar       = S.tilde + t(Y)%*%Y + t(A.tilde)%*%diag(1/diag(V.tilde))%*%A.tilde -\n                t(A.bar)%*%V.bar.inv%*%A.bar\n  S.bar.inv   = solve(S.bar)\n  \n\n  # Posterior draws \n  Sigma.posterior   = rWishart(S, df=nu.bar, Sigma=S.bar.inv)\n  Sigma.posterior   = apply(Sigma.posterior,3,solve)\n  Sigma.posterior   = array(Sigma.posterior,c(N,N,S))\n  A.posterior       = array(rnorm(prod(c(dim(A.bar),S))),c(dim(A.bar),S))\n  L                 = t(chol(V.bar))\n  for (s in 1:S){\n    A.posterior[,,s]= A.bar + L%*%A.posterior[,,s]%*%chol(Sigma.posterior[,,s])\n    }\n  output            = list(A.posterior=A.posterior, Sigma.posterior=Sigma.posterior)\n  return(output)\n}\nsample_dummy        = posterior_draws_dummy(S = 50000, Y, X, A.prior, V.prior, S.prior, nu.prior)\nsample_dummy_A      = sample_dummy$A.posterior\nsample_dummy_Sigma  = sample_dummy$Sigma.posterior\n\n\n\n\n\nPosterior A means and standard deviations table\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n0.109378\n0.960144\n-0.021032\n0.054659\n-0.161725\n-0.037150\n0.005050\n0.014763\n0.155331\n-0.051809\n0.007478\n0.005357\n0.036278\n0.028091\n0.002429\n0.002725\n-0.001100\n\n\n3.243886\n0.116815\n0.335138\n0.356141\n0.108669\n0.128781\n0.200228\n0.204205\n0.144081\n0.099879\n0.136838\n0.137718\n0.106364\n0.075543\n0.103837\n0.103470\n0.071154\n\n\n0.005263\n0.005680\n0.998495\n-0.000387\n0.001170\n0.001233\n-0.000250\n-0.000071\n0.000605\n-0.002361\n-0.000029\n-0.000044\n-0.000632\n-0.001195\n0.000056\n-0.000048\n-0.001226\n\n\n0.107422\n0.003839\n0.011044\n0.011822\n0.003552\n0.004237\n0.006584\n0.006644\n0.004734\n0.003296\n0.004497\n0.004546\n0.003507\n0.002507\n0.003419\n0.003438\n0.002339\n\n\n\n\n\n\n\n\n\n\nPosterior Sigma means and standard deviations table\n\n\n1\n2\n3\n4\n\n\n\n\n0.176142\n-0.002082\n-0.000106\n-0.029608\n\n\n0.024464\n0.000600\n0.000060\n0.015212\n\n\n-0.002082\n0.000191\n0.000004\n0.000509\n\n\n0.000600\n0.000026\n0.000002\n0.000493\n\n\n\n\n\n\n\n\nSimilarly to the baseline model, the trace plots and histograms posterior draws on A and \\(\\Sigma\\) shows that unemployment rate has strong positive correlation with its first lag."
  },
  {
    "objectID": "index.html#markov-switching",
    "href": "index.html#markov-switching",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Markov Switching",
    "text": "Markov Switching\nThe regime-change mechanism assumes that the regime can change over time. At each period, the regime can either stay the same or switch to the other regime.\nProbability of regimes \\[\\begin{align}\n\\begin{bmatrix}\np_{1} & p_{2}\\\\\n\\end{bmatrix}\n\\end{align}\\]\nProbability transition matrix \\[\\begin{align}\n\\begin{bmatrix}\np_{11} & p_{12}\\\\\np_{21} & p_{22}\\\\\n\\end{bmatrix}\n\\end{align}\\]\n\\(p_{11}\\): the probability of staying in regime 1 in the next period.\n\\(p_{12}\\): the probability of switching from regime 1 to regime 2 in the next period.\n\\(p_{21}\\): the probability of switching from regime 2 to regime 1 in the next period.\n\\(p_{22}\\): the probability of staying in regime 2 in the next period.\n\\[\\begin{align}\n\\xi_{t} = \\begin{bmatrix}\n1\\\\\n0\\\\\n\\end{bmatrix}, if  s_t = 1\n\\end{align}\\]\n\\[\\begin{align}\n\\xi_{t} = \\begin{bmatrix}\n0\\\\\n1\\\\\n\\end{bmatrix}, if  s_t = 2\n\\end{align}\\]\nThe sampling process involves:\n\nSets up arrays to store posterior draws for parameters \\(A\\), \\(\\Sigma\\), regime assignments \\(\\xi\\), regime probabilities \\(\\pi\\), transition probabilities \\(P\\).\nInitializes values for \\(\\xi\\), \\(\\pi\\), \\(P\\).\nGibbs sampler method generate random draws, iterates through each sampling s.\nFor each iteration, subsets the data Y and X based on the current regime assignment \\(\\xi\\), obtain posterior parameters, and draw posterior samples.\nUpdate Z (the residuals), for the next iteration.\n\nThe posterior draws are obtain with the following code\n\n# Gibbs sampling function\nGibbs_draws = function(S, Y, X, xi, P, pi) {\n  N = ncol(Y)\n  p = (ncol(X) - 1) / N \n  M = 2   # Number of regimes\n  T = nrow(Y)\n  \n  Sigma.posterior.draws1 = array(NA, c(N, N, S))\n  Sigma.posterior.draws2 = array(NA, c(N, N, S))\n  A.posterior.draws1 = array(NA, c((1 + p * N), N, S))\n  A.posterior.draws2 = array(NA, c((1 + p * N), N, S))\n  xi.draws &lt;- array(NA, dim = c(M, T, S))\n  P.draws &lt;- array(NA, c(2, 2, S))\n  pi.draws &lt;- matrix(NA, nrow = M, ncol = S)\n\n  P = 0.95 * diag(2) + 0.025\n  pi = c(0.5, 0.5)\n  xi = rbind(c(rep(1,50), rep(0,T-50)), c(rep(0,50), rep(1,T-50)))\n  Z = array(rnorm(T*N*M), c(N,T,M))\n\n  \n  for (s in 1:S) {\n    # Update xi, P, and pi using the sample_Markov_process function\n    gibbs_draw = sample_Markov_process(Z, xi, P, pi)\n    xi = gibbs_draw$aux_xi\n    P = gibbs_draw$aux_PR_TR\n    pi = gibbs_draw$aux_pi_0\n    \n    xi.draws[, , s] &lt;- xi\n    P.draws[, , s] &lt;- P\n    pi.draws[, s] &lt;- pi\n    \n    # Loop to get regime-specific Y, X, Sigma, A\n    for (m in 1:2) {\n      Y_m =  Y[xi[m,]==1,]\n      X_m =  X[xi[m,]==1,]\n      T_m = nrow(Y_m)\n      \n      if (T_m &gt; 0) {\n        # Posterior parameters\n        V.bar.inv = t(X_m) %*% X_m + diag(1 / diag(V.prior))\n        V.bar = solve(V.bar.inv)\n        A.bar = V.bar %*% (t(X_m) %*% Y_m + diag(1 / diag(V.prior)) %*% A.prior)\n        nu.bar = T_m + nu.prior\n        S.bar = S.prior + t(Y_m) %*% Y_m + t(A.prior) %*% diag(1 / diag(V.prior)) %*% A.prior - t(A.bar) %*% V.bar.inv %*% A.bar\n        S.bar.inv = solve(S.bar)\n        \n        # Posterior draws for Sigma\n        Sigma.posterior = rWishart(1, df = nu.bar, Sigma = S.bar.inv)\n        Sigma.posterior = solve(Sigma.posterior[, , 1])\n        if (m == 1) {\n          Sigma.posterior.draws1[, , s] = Sigma.posterior\n        } else {\n          Sigma.posterior.draws2[, , s] = Sigma.posterior\n        }\n        \n        # Posterior draws for A\n        L = t(chol(V.bar))\n        xx = matrix(rnorm(prod(dim(A.bar))), dim(A.bar)[1], dim(A.bar)[2])\n        \n        A.posterior &lt;- A.bar + L %*% xx %*% chol(Sigma.posterior)\n        if (m == 1) {\n          A.posterior.draws1[, , s] = A.posterior\n        } else {\n          A.posterior.draws2[, , s] = A.posterior\n        }\n        \n        # Compute Z_m for the next iteration\n        LL = t(chol(Sigma.posterior))\n        Z[, , m] &lt;-   t((Y - X %*% A.posterior) %*% LL)\n      }\n    }\n  }\n\n  output = list(\n    A.posterior1 = A.posterior.draws1,\n    A.posterior2 = A.posterior.draws2,\n    Sigma.posterior1 = Sigma.posterior.draws1,\n    Sigma.posterior2 = Sigma.posterior.draws2,\n    xi = xi.draws,\n    P = P.draws,\n    pi = pi.draws\n  )\n  return(output)\n}\n\nTo examine how the regime draws are distributed between the two states, we visualize the switching variable \\(\\xi\\). Initially, the plot suggests that the regime assignments appear arbitrary. To address this issue, a label switching procedure is implemented to ensure consitency in how the two regimes are identified, in this case regime 1 is identified as the state with higher volatility. For each iteration s, we evaluate the \\(\\Sigma\\) and switch the one with higher volatility to regime 1, updating the corresponding \\(A\\), \\(\\xi\\), \\(\\pi\\), \\(P\\). Following the label switching, the distinction between the two regimes becomes more evident. The drawn regimes indicate that regime 1 corresponds to the period around 2020, which aligns with the Covid-19 pandemic. This finding is intuitive as the Covid-19 pandemic significantly impacted the economy at large, including unemployment rates. Regime 2, on the other hand, represents other periods.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRegime 1 Posterior A means and standard deviations table\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n0.316886\n0.987699\n-0.004379\n0.019651\n-0.128876\n-0.066004\n0.005840\n0.003655\n0.087500\n-0.037444\n0.004902\n0.001665\n0.036290\n0.008789\n0.002809\n0.000623\n0.016396\n\n\n4.579147\n0.245385\n0.462288\n0.517717\n0.210322\n0.227110\n0.273410\n0.280962\n0.234766\n0.161253\n0.187338\n0.191290\n0.158211\n0.123496\n0.142242\n0.142651\n0.114609\n\n\n-0.009075\n0.003698\n0.998953\n0.000655\n0.001413\n0.001634\n-0.000226\n0.000111\n0.000430\n-0.001153\n-0.000101\n0.000086\n-0.000333\n-0.000704\n0.000017\n0.000046\n-0.000903\n\n\n0.147534\n0.008456\n0.014858\n0.016655\n0.006463\n0.007686\n0.008866\n0.009089\n0.007280\n0.005341\n0.006080\n0.006135\n0.005086\n0.004042\n0.004572\n0.004631\n0.003669\n\n\n\n\n\n\n\n\n\n\nRegime 1 Posterior Sigma means and standard deviations table\n\n\n1\n2\n3\n4\n\n\n\n\n0.332383\n-0.003033\n-0.000152\n-0.038300\n\n\n0.083753\n0.002432\n0.000186\n0.044302\n\n\n-0.003033\n0.000345\n0.000005\n0.000676\n\n\n0.002432\n0.000101\n0.000006\n0.001402\n\n\n\n\n\n\n\n\n\n\nRegime 2 Posterior A means and standard deviations table\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n-0.096053\n0.972897\n-0.006798\n0.058393\n-0.105348\n-0.025707\n0.001306\n0.015532\n0.104734\n-0.041000\n0.003113\n0.006194\n0.036421\n0.009507\n0.001743\n0.003292\n-0.000216\n\n\n3.701503\n0.185834\n0.372567\n0.413256\n0.166425\n0.178010\n0.222131\n0.225355\n0.189637\n0.127066\n0.150843\n0.152754\n0.125474\n0.097754\n0.114329\n0.115042\n0.089384\n\n\n0.004280\n0.004430\n0.999113\n-0.000701\n0.000640\n0.000463\n-0.000142\n-0.000235\n0.000003\n-0.001327\n-0.000001\n-0.000105\n-0.000367\n-0.000753\n0.000027\n-0.000049\n-0.000512\n\n\n0.125892\n0.006916\n0.012706\n0.014065\n0.005289\n0.006457\n0.007576\n0.007739\n0.006114\n0.004499\n0.005204\n0.005237\n0.004274\n0.003407\n0.003923\n0.003927\n0.003055\n\n\n\n\n\n\n\n\n\n\nRegime 2 Posterior Sigma means and standard deviations table\n\n\n1\n2\n3\n4\n\n\n\n\n0.215171\n-0.001017\n-6.6e-05\n-0.023592\n\n\n0.042905\n0.001485\n1.2e-04\n0.028948\n\n\n-0.001017\n0.000251\n2.0e-06\n0.000304\n\n\n0.001485\n0.000066\n4.0e-06\n0.001030\n\n\n\n\n\n\n\n\nThe trace plots and histograms posterior draws on A and \\(\\Sigma\\) shows that unemployment rate has strong positive correlation with its first lag. The sigma plots shows that regime 1 has higher volatility than regime 2, which is expected considering label switching set up."
  },
  {
    "objectID": "index.html#baseline-model",
    "href": "index.html#baseline-model",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Baseline model",
    "text": "Baseline model\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe plot of point forecast and density for 21 periods ahead, equivalent to 21 quarters or 5 years and 1 quarter from Q4 2023 to Q4 2028 shows a clear upward trend. The confidence interval is quite large. The unemployment rate seems to converge to the mean and has a slight downward trend in the last horizons.\nFor the 3D plot of the density, we can see that the further the period ahead, the density is more dispersed since the data is become less informative as horizon increases."
  },
  {
    "objectID": "index.html#baseline-model-extension-1---dummy-observation-prior",
    "href": "index.html#baseline-model-extension-1---dummy-observation-prior",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Baseline Model Extension 1 - Dummy observation prior",
    "text": "Baseline Model Extension 1 - Dummy observation prior\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe plot of forecast for the dummy observation prior doesn’t show any significant differences visually. The confidence interval narrowed insignificantly."
  },
  {
    "objectID": "index.html#baseline-model-extension-2---regime-change-1",
    "href": "index.html#baseline-model-extension-2---regime-change-1",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Baseline Model Extension 2 - Regime change",
    "text": "Baseline Model Extension 2 - Regime change\nAfter the regimes are correctly placed, we can forecast h-step ahead using the posterior draws.\n\nMarkov_forecast &lt;- function(S, sample, Y, p, h) {\n  N &lt;- ncol(Y)\n  # Initialize the array to store forecasts\n  Y.h = array(NA, c(h, 2, S))\n\n  for (s in 1:S){\n    A.posterior.draw1 = sample$A.posterior1[,,s]\n    A.posterior.draw2 = sample$A.posterior2[,,s]\n    Sigma.posterior1 = sample$Sigma.posterior1[,,s]\n    Sigma.posterior2 = sample$Sigma.posterior2[,,s]\n  \n    T = dim(sample$xi)[2]\n  \n    x.Ti = Y[(nrow(Y)-p+1):nrow(Y),]\n    x.Ti = x.Ti[p:1,]\n    \n    P_h = sample$P[,,s] %*% sample$xi[,T,s]  # Initializing P_h\n  \n    for (i in 1:h){\n      x.T = c(1, as.vector(t(x.Ti)))\n    \n      if (i &gt; 1) {  # Only update P_h if i &gt; 1\n        P_h = sample$P[,,s] %*% P_h\n      }\n      sample_m = sample.int(2,1, prob=as.numeric(P_h))\n    \n      if (sample_m == 1) {\n        A.posterior.draw = A.posterior.draw1\n        Sigma.posterior = Sigma.posterior1\n      } else {\n        A.posterior.draw = A.posterior.draw2\n        Sigma.posterior = Sigma.posterior2\n      }\n    \n      Y.f = rmvnorm(1, mean = x.T %*% A.posterior.draw, sigma = Sigma.posterior)\n      x.Ti = rbind(Y.f, x.Ti[1:(p-1),])\n      Y.h[i,,s] = Y.f[1:2]\n    }\n  }\n  return(Y.h)\n}\n\nThe plot below shows the forecast using Minnesota prior and regime change for unemployment rate.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe point forecasts exhibit a positive trend towards the mean with a slight downward trend observed in the last few forecast horizons. When examining the 3D density intervals, it becomes apparent that the intervals remain relatively stable across all horizons, which can likely be attributed to the regime change effect. Therefore, regime change helps maintain stable forecast uncertainty levels throughout different forecast horizons."
  },
  {
    "objectID": "index.html#model-with-minnesota-prior-dummy-observation-prior-and-regime-change-1",
    "href": "index.html#model-with-minnesota-prior-dummy-observation-prior-and-regime-change-1",
    "title": "Forecasting Unemployment rate in Australia using Bayesian VARs with Regime change",
    "section": "Model with Minnesota prior, dummy observation prior and regime change",
    "text": "Model with Minnesota prior, dummy observation prior and regime change\nThe prior is be a combination of Minnesota and dummy observation prior. The Markov-switching Gibb-sampling is done with these new priors to obtain the posterior draws.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe forecast shows positive upward trend, converging to the mean, the downward trend for the last horizons is less evident. The plot shows higher density intervals in the last few horizons, indicating increased forecast uncertainty. This can be due to dummy observation prior’s intention to guide the model towards specific trends or patterns, which result in the model to react differently. For example, in the last few horizons, the dummy observation prior might reinforce the influence of the regime change, leading to higher uncertainty in the forecasts. This suggests that the model is more responsive to economic conditions and less confident in its predictions as it approaches the end of the forecast period.\nThe below is an interactive density intervals for easier inspection."
  }
]